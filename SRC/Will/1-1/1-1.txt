This is the base code written by Will C. plus the directory searching code written by Andrew.

No changes.